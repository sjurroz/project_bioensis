
\section{Materiales y métodos}
Para este trabajo se realizó un análisis exhaustivo de la red de interacción proteína-proteína (PPI, \textit{protein-protein interaction}) del fenotipo de interés, en donde se utilizaron diferentes herramientas que posibilitaron el estudio de la red. Entre ellas destaca STRING (\textit{Search Tool for the Retrieval of Interacting Genes/protein}), una base de datos biológica y un servidor web de acceso libre enfocado principalmente en las PPIs. Esta herramienta es útil para integrar las asociaciones funcionales entre las proteínas de un organismo.

A su vez se utilizó HPO (Human Gene Ontology), un vocabulario estandarizado que utilizan médicos e investigadores para describir de manera uniforme y precisa anomalías fenotípicas observadas en enfermedades humanas. 

La implementación se realizó en Python, debido a su versatilidad, simplicidad en la sintaxis y amplia disponibilidad de bibliotecas especializadas, que facilitan tanto la comunicación con las APIs de las bases de datos más utilizadas como la representación gráfica de redes complejas. Específicamente, se utilizaron las siguientes librerías:

\begin{itemize}
	\item \texttt{Numpy} (v. 1.26.4): librería esencial para cálculos numéricos y operaciones matriciales.
	
	\item \texttt{Matplotlib} (v. 3.9.2): librería para visualizar datos e imágenes y generar gráficas.
	
	\item \texttt{Pandas} (v. 2.2.3): librería para manipular, limpiar y analizar datos en forma de tablas (\textit{DataFrames}).
	
	\item \texttt{Requests} (v. 2.32.3): librería para realizar solicitudes HTTP y comunicarse con APIs o servicios web.
	
	\item \texttt{Json}: módulo para leer, escribir y procesar datos en formato JSON. Es parte de la biblioteca estándar de Python, por lo que no requiere instalación ni tiene versión propia.
	
	\item \texttt{NetworkX} (v 3.6.0): librería para crear, analizar y visualizar redes o grafos, con soporte para métricas y tareas adicionales.
\end{itemize}

El flujo de trabajo diseñado (\autoref{fig:diagramadeflujobiosis}) consta de cinco etapas que abarcan desde la obtención de genes relacionados con el fenotipo de interés hasta la extracción de conocimiento biológico de la red PPI. Para algunas de las etapas se realizaron múltiples ejecuciones, variando en cada una los parámetros principales. De esta forma, se obtuvieron múltiples combinaciones de resultados, con el objetivo de evaluar qué configuración presentaba los resultados más favorables para luego profundizar sobre ella.

\begin{figure}[h!]
	\centering
	\includegraphics[width=0.7\linewidth]{figures/FlujoDeTrabajo.png}
	\caption{Esquema conceptual del flujo de trabajo.}
	\label{fig:diagramadeflujobiosis}
\end{figure}

En primer lugar, se recopiló la lista de genes asociados al fenotipo de interés. Para hacerlo, se adoptaron dos vías distintas: por un lado, se utilizaron los genes encontrados tras una revisión bibliográfica manual (\autoref{tab:genes_introduccion}, 35 genes); por el otro, se extrajeron programáticamente a partir de la API de la HPO (49 genes). Los 35 genes de la primera estrategia (la cual, a lo largo del trabajo, será referida como "manual") están contenidos dentro de los 49 genes de la segunda.

A continuación, mediante la API de STRING, se generó la red PPI para cada una de las dos listas de genes. En este punto se propusieron tres posibles umbrales de puntuación para dar lugar a la red: uno laxo, con un valor de 300; otro intermedio, de 700; y el más estricto, igual a 900. Esto permitió comparar cómo varía la estructura de la red en función del nivel de confianza asignado a las interacciones, evaluando si los patrones observados se mantienen consistentes al aumentar el umbral de evidencia requerido. Una vez obtenidas las seis redes, se representaron gráficamente mediante la librería \texttt{NetworkX}. Para cada una de ellas, se llevó a cabo un pequeño análisis exploratorio inicial, en el cual se midieron distintas propiedades básicas de topología como número de nodos, grado, densidad, centralidad, modularidad y dispersión.

Luego, resultó necesario establecer los posibles agrupamientos o \textit{clusters} que tuvo cada red. Este proceso se llevó a cabo con el objetivo de descubrir grupos de genes altamente conectados entre sí, los cuales podrían corresponder a funciones biológicas relacionadas con la ELA. Nuevamente, se propusieron tres estrategias diferentes de agrupamiento:


\begin{itemize}
	\item\textbf{\textit{Clustering} basado en la centralidad de intermediación de enlace (Edge Betweenness \textit{Clustering})}: es un método de detección de comunidades propuesto por Girvan y Newman en el año 2002 \cite{newman2004modularity} Este algoritmo consiste en calcular la centralidad de intermediación para todas las aristas donde se eliminan aquellas con los valores más altos, dicho proceso se hace de manera iterativa con el objetivo de separar la red en subconjuntos mayormente conectados de forma interna.
	
	Este proceso continúa hasta obtener la red con agrupamientos que presenten el valor más alto de la modularidad, la cual cuantifica la calidad de la conexión interna de los agrupamientos respecto al resto de la red.. Dicha métrica tiene un intervalo [-1,1] donde el valor más cercano o igual a 1 determina que el  agrupamiento está bien definido (\autoref{tab:valores_modularidad}). 
	
	\begin{table}[ht]
		\centering
		\renewcommand{\arraystretch}{1.4}
		\setlength{\tabcolsep}{6pt}
		\begin{tabular}{|p{3cm}|p{10cm}|}
			\hline
			\textbf{Valor de $Q$} & \textbf{Interpretación} \\
			\hline
			$Q \approx 1$ & Agrupamiento fuerte y bien definido. \\
			\hline
			$0 < Q < 1$ & Partición clara, aunque no completamente aislada, ya que existe cierta conectividad entre los agrupamientos. \\
			\hline
			$Q \approx 0$ & Estructura compuesta principalmente por conexiones aleatorias. \\
			\hline
			$-1 < Q < 0$ & La partición es peor que el azar, con más conexiones entre comunidades que dentro de ellas. \\
			\hline
			$Q \approx -1$ & Agrupamiento totalmente incoherente. \\
			\hline
		\end{tabular}
		\caption{\textbf{Significado de los valores de la modularidad (Q).}}
		\label{tab:valores_modularidad}
	\end{table}
	
	\item \textbf{\textit{Clustering} basado en el algoritmo InfoMap}: es un método de detección de comunidades propuesto por Martin Rosvall y Carl T. Bergstrom en el año 2008 \cite{rosvall2008infomap}, que no depende de una métrica estructural predeterminada y detecta comunidades de tamaño variable con submódulos jerárquicos. Este algoritmo detecta los agrupamientos analizando el flujo de información entre nodos usando caminatas aleatorias que simulan el movimiento dentro de una red y eligen el próximo nodo al azar. Las múltiples caminatas se utilizan para calcular la cantidad de bits que se necesitan para describir el recorrido: si el recorrido pasó una gran parte dentro de un mismo grupo de nodos se considera una comunidad densamente conectada internamente; en el caso contrario, se considera que hay una conexión más débil entre comunidades.  
	
	\item \textbf{\textit{Clustering} basado en el algoritmo Fast Greedy}: es un método jerárquico que optimiza directamente la modularidad de una red para detectar comunidades, introducido por Clauset, Newman y Moore (2004) \cite{clauset2004finding}. Parte de la hipótesis de que una buena partición es aquella en la que los nodos se conectan con mayor frecuencia dentro de su propio grupo que con nodos externos. Comienza considerando cada nodo como una comunidad independiente y, de forma iterativa, fusiona los pares de comunidades cuya unión produce el mayor aumento en la modularidad global. Este criterio local permite construir una estructura jerárquica (dendrograma) que refleja niveles anidados de organización. Gracias a su implementación eficiente, es especialmente útil para redes grandes o densas, donde métodos más costosos como el Edge Betweenness se vuelven inviables.
	
\end{itemize}


A partir de estas ejecuciones, se generaron dieciocho resultados en total: tres conjuntos de \textit{clusters} —uno por cada algoritmo— para cada una de las seis redes analizadas. Luego, se llevó a cabo sobre cada uno de ellos un análisis de enriquecimiento funcional de sobrerrepresentación (ORA, \textit{Over-Representation Analysis}) como aproximación inicial al posible significado biológico de los módulos individuales identificados en cada red.  Para estos análisis de sobrerrepresentación, así como para todos los análisis posteriores, se consideraron únicamente aquellos \textit{clusters} con al menos 3 genes, con el fin de evitar ruido derivado de agrupamientos demasiado pequeños y asegurar una mínima coherencia funcional. Además, se estableció como valor umbral de significancia estadística un \textit{p}-valor ajustado de 0.05, y se recurrió a Gene Ontology (GO) Biological Process como base de datos de referencia.

Finalmente, se examinó el equilibrio entre el número de \textit{clusters} y la media de funciones enriquecidas por \textit{cluster}, buscando la configuración con el mejor compromiso entre estructura de la red y coherencia funcional. 

Para llevar a cabo un estudio aún más exhaustivo de la red con mejor configuración según el equilibrio previamente explicado, se recurrió a dos enfoques opuestos pero complementarios. Por una parte, se utilizó una validación técnica, basada en principios de topología de redes (calculando las métricas ya mencionadas como densidad, centralidad y modularidad, entre otras), pero teniendo en cuenta el número de \textit{clusters}. Por otro lado, para profundizar en el significado biológico, se ejecutaron enriquecimientos funcionales adicionales. A los resultados ya obtenidos con GO Biological Process, se añadieron dos bases de datos ampliamente utilizadas: Kyoto Encyclopedia of Genes and Genomes (KEGG) y Reactome. Estas bases de datos son complementarias entre sí, ya que GO se centra en procesos biológicos generales, KEGG incorpora rutas metabólicas y de señalización, y Reactome se especializa en eventos moleculares y vías celulares.



